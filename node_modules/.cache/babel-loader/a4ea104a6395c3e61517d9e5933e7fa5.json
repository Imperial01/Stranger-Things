{"ast":null,"code":"import { useHistory } from \"react-router-dom\";\nconst cohortName = \"2204-FTB-MT-WEB-PT\";\nconst APIURL = `https://strangers-things.herokuapp.com/api/${cohortName}`;\nconst history = useHistory();\nexport const fetchAllPost = async token => {\n  const response = await fetch(`${APIURL}/posts`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    }\n  });\n  const result = await response.json();\n  return result.data.posts;\n};\nexport const fetchCreateForm = async (token, title, description, price, location) => {\n  const response = await fetch(`${APIURL}/posts`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    },\n    body: JSON.stringify({\n      post: {\n        title: title,\n        description: description,\n        price: price,\n        location: location\n      }\n    })\n  });\n  const result = await response.json();\n  console.log(result.data.post);\n  return result.data.post;\n};\nexport const fetchRegister = async (userName, password) => {\n  const response = await fetch(`${APIURL}/users/register`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      user: {\n        username: userName,\n        password: password\n      }\n    })\n  });\n  const result = await response.json();\n  console.log(result);\n\n  if (!result.success) {\n    alert(result.error.message);\n  } else {\n    return result.data.token;\n  }\n};\nexport const fetchLogin = async (userName, password) => {\n  const response = await fetch(`${APIURL}/users/login`, {\n    method: \"POST\",\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      user: {\n        username: userName,\n        password: password\n      }\n    })\n  });\n  const result = await response.json();\n\n  if (!result.success) {\n    alert(result.error.message);\n    history.push('/');\n  } else {\n    return result.data.token;\n  }\n};\nexport const fetchDelete = async (token, postID, selectedPost, posts, setPosts) => {\n  const response = await fetch(`${APIURL}/posts/${postID}`, {\n    method: \"DELETE\",\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    }\n  });\n  const result = await response.json();\n  console.log(result);\n\n  if (result.success) {\n    window.confirm('Are you sure you want to DELETE this post?'); //BUG: still deletes when pressing NO\n\n    const newPost = posts.filter(post => post._id !== selectedPost);\n    console.log(newPost);\n    setPosts(newPost);\n  } else {\n    alert(\"UNAUTHORIZED TO DELETE\");\n  }\n};\nexport const fetchMessage = async (postID, token, comment) => {\n  const response = await fetch(`${APIURL}/posts/${postID}/messages`, {\n    method: \"POST\",\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    },\n    body: JSON.stringify({\n      message: {\n        content: comment\n      }\n    })\n  });\n  const result = await response.json();\n  console.log(result);\n  return result.data.message.content;\n};\nexport const fetchUserData = async token => {\n  const response = await fetch(`${APIURL}/users/me`, {\n    method: \"GET\",\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    }\n  });\n  const result = await response.json();\n  console.log(result.data);\n  return result.data.messages;\n};","map":{"version":3,"names":["useHistory","cohortName","APIURL","history","fetchAllPost","token","response","fetch","method","headers","result","json","data","posts","fetchCreateForm","title","description","price","location","body","JSON","stringify","post","console","log","fetchRegister","userName","password","user","username","success","alert","error","message","fetchLogin","push","fetchDelete","postID","selectedPost","setPosts","window","confirm","newPost","filter","_id","fetchMessage","comment","content","fetchUserData","messages"],"sources":["/Users/adrianimperial/Desktop/Course_work/Stranger things/src/utility/api.js"],"sourcesContent":["import { useHistory } from \"react-router-dom\";\n\nconst cohortName = \"2204-FTB-MT-WEB-PT\";\nconst APIURL = `https://strangers-things.herokuapp.com/api/${cohortName}`;\n\nconst history = useHistory(); \nexport const fetchAllPost = async (token) => {\n  const response = await fetch(`${APIURL}/posts`, {\n    method: 'GET',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    }\n  })\n  const result = await response.json();\n    return (result.data.posts)\n  };\n\n\nexport const fetchCreateForm = async (token, title, description, price, location) => {\n  const response = await fetch(`${APIURL}/posts`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    },\n    body: JSON.stringify({\n      post: {\n        title: title,\n        description: description,\n        price: price,\n        location: location\n      }\n    })\n  })\n  const result = await response.json();\n  console.log(result.data.post)\n  return result.data.post \n\n}\n\nexport const fetchRegister = async (userName, password) => {\n  const response = await fetch(`${APIURL}/users/register`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      user: {\n        username: userName,\n        password: password\n      }\n    })\n    \n  })\n  const result = await response.json();\n  console.log(result)\n  if(!result.success){\n    alert(result.error.message)\n  }else{\n    return (result.data.token)\n  }\n  \n}\n\n\nexport const fetchLogin = async (userName, password) => {\n  const response = await fetch(`${APIURL}/users/login`, {\n    method: \"POST\",\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      user: {\n        username: userName,\n        password: password \n      }\n    })\n  })\n\n  const result = await response.json()\n  if(!result.success){\n    alert(result.error.message)\n    history.push('/') \n  }else {\n  return result.data.token\n  }\n  \n}\n\nexport const fetchDelete = async (token, postID, selectedPost, posts, setPosts) => {\n  const response = await fetch(`${APIURL}/posts/${postID}`, {\n    method: \"DELETE\",\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    }\n  })\n  const result = await response.json()\n  console.log(result)\n  if (result.success){\n    window.confirm('Are you sure you want to DELETE this post?') //BUG: still deletes when pressing NO\n    const newPost = posts.filter(post => post._id !== selectedPost)\n    console.log(newPost)\n    setPosts(newPost)\n  } else{\n    alert(\"UNAUTHORIZED TO DELETE\")\n  }\n  \n}\n\nexport const fetchMessage = async (postID, token, comment) => {\n  const response = await fetch(`${APIURL}/posts/${postID}/messages`, {\n    method: \"POST\",\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    },\n    body: JSON.stringify({\n      message: {\n        content: comment\n      }\n    })\n  })\n\n  const result = await response.json();\n  console.log(result)\n  return result.data.message.content\n  \n}\n\n\nexport const fetchUserData = async (token) =>{\n  const response = await fetch(`${APIURL}/users/me`, {\n    method: \"GET\",\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}`\n    }\n  })\n  const result = await response.json();\n  console.log(result.data)\n  return result.data.messages\n  \n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}